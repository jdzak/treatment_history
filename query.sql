-- select count(*),
--   case
--     when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1980 and 1985 then '1980-1985'
--     when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1986 and 1990 then '1986-1990'
--     when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1991 and 1995 then '1991-1995'
--     when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1996 and 2000 then '1996-2000'
--     when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 2001 and 2005 then '2001-2005'
--     when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 2006 and 2010 then '2006-2010'
--     when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 2011 and 2013 then '2011-2013' end as year_range
-- from CITATIONS
-- group by year_range
-- limit 1000;

-- SELECT count(*), s_cui, s_name FROM PREDICATION_AGGREGATE pa join SENTENCE s on s.sentence_id =  pa.sid WHERE predicate = 'TREATS'  AND o_CUI IN('C0153957','C0018787','C1281570','C0153500','C1646326','C0018801','C0018802')  AND s_novel = 1  group by s_cui, s_name order by count(*) desc;

--- Congestive Hearth Failure (with novel)
SELECT count(*), s_cui, s_name,
  case
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1980 and 1985 then '1980-1985'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1986 and 1990 then '1986-1990'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1991 and 1995 then '1991-1995'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1996 and 2000 then '1996-2000'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 2001 and 2005 then '2001-2005'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 2006 and 2010 then '2006-2010'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 2011 and 2013 then '2011-2013' end as year_range
FROM PREDICATION_AGGREGATE pa 
join SENTENCE s on s.sentence_id =  pa.sid 
join CITATIONS c on c.pmid = s.pmid
WHERE predicate = 'TREATS'  
AND o_CUI IN('C0153957','C0018787','C1281570','C0153500','C1646326','C0018801','C0018802')  
AND s_novel = 1  
group by s_cui, s_name, year_range
having year_range <> NULL
order by year_range, s_name;

--- Congestive Hearth Failure (with novel and pmids)
SELECT count(*), s_cui, s_name,
  case
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1980 and 1985 then '1980-1985'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1986 and 1990 then '1986-1990'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1991 and 1995 then '1991-1995'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1996 and 2000 then '1996-2000'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 2001 and 2005 then '2001-2005'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 2006 and 2010 then '2006-2010'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 2011 and 2013 then '2011-2013' end as year_range
FROM (select s_cui, s_name, sid, o_cui from PREDICATION_AGGREGATE WHERE pmid IN (19075089,19147446,19165563,19238541,19241160,19259090,19287017,19298563,19327624,19329498,19329820,19395556,19429638,19448327,19464414,19477397,19477400,19561363,19567409,19690393,19699885,19782785,19782789,19789395,19829143,19850207,19880673,19910894,19919976,19937388,20025703,20060737,20123246,20136608,20152247,20176716,20350695,20376643,20425165,20459399,20494923,20513750,20560030,20560033,20569719,20625111,20625642,20650361,20657270,20670760,20670761,20672565,20709866,20795939,20797593,20800804,20801495,20801500,20844613,20974767,21036891,21092890,21098426,21109913,21111923,21125288,21127379,21185153,21208157,21214089,21216832,21252013,21269649,21300298,21353251,21382893,21390582,21402600,21414567,21431901,21442576,21450567,21453215,21463153,21463154,21490036,21516074,21547624,21562061,21565866,21613427,21645332,21712261,21747195,21750125,21813108,21828333,21875862,21900185,21906812,21922233,21939839,21982313,22017475,22034480,22064591,22083298,22088800,22104549,22112740,22123359,22147616,22282104,22285578,22286156,22310153,22340263,22342270,22348447,22369914,22405632,22424012,22427524,22460822,22510230,22549295,22553307,22617188,22696519,22709747,22724260,22727431,22781424,22785005,22808826,22830441,22839442,22848075,22882472,22918216,22922413,22962420,22965994,22989293,23000040,23018991,23032716,23060423,23170968,23174486,23180520,23244364,23245443,23252875,23294824,23308171,23343556,23465286,23500267,23537041,23537892,23540545,23541971,23618535,23622913,23731606,23916925,23942679,23970363,24002794)) pa
join SENTENCE s on s.sentence_id =  pa.sid 
join CITATIONS c on c.pmid = s.pmid
WHERE predicate = 'TREATS'  
AND o_CUI IN('C0153957','C0018787','C1281570','C0153500','C1646326','C0018801','C0018802')  
AND s_novel = 1  
group by s_cui, s_name, year_range
having year_range <> NULL
order by year_range, s_name;

--- atrial fibrillation (Original)
-- SELECT DISTINCT SENTENCE, PREDICATION_AGGREGATE.PMID, s_cui, s_name, o_cui, o_name, predicate
-- FROM PREDICATION_AGGREGATE, SENTENCE
-- WHERE PREDICATION_AGGREGATE.PMID IN(18070948,18619686,18678424,18694603,18775040,18834823,18977068,19017345,19017348,19034639,19060419,19095714,19109347,19111766,19129422,19136164,19141561,19144672,19167636,19168461,19175841,19176561,19187079,19187902,19188521,19202157,19207134,19207759,19207781,19213680,19216053,19233678,19237995,19245970,19249410,19249447,19250103,19251200,19252110,19261038,19261602,19264245,19266096,19266272,19272058,19282274,19282313,19304990,19326955,19327322,19332460,19335861,19336502,19349144,19350783,19351628,19359813,19363053,19363054,19369667,19372098,19376304,19376321,19383241,19390072,19401341,19419397,19436116,19447800,19447807,19460059,19460078,19460849,19463518,19487941,19502623,19515090,19521238,19528305,19531542,19531579,19535417,19540387,19549643,19549678,19553398,19559266,19564557,19570119,19581635,19590588,19614639,19616670,19617253,19619690,19619795,19629889,19633305,19645836,19656736,19659616,19659628,19663955,19666432,19666643,19679590,19683639,19688104,19690349,19691996,19698856,19699858,19699916,19717844,19717850,19732237,19738139,19744150,19744618,19752319,19752363,19756816,19772579,19774220,19793149,19793367,19793371,19794976,19808442,19808454,19808455,19808490,19808495,19818194,19822977,19834326,19843915,19851648,19853699,19853700,19891247,19911349,19925605,19926008,19927630,19932501,19933238,19933534,19933935,19934136,19941430,19942634,19944393,19944872,19948506,19996947,19998831,20001998,20009074,20009077,20021517,20022876,20036036,20042769,20051297,20061035,20061328,20062939,20066882,20074258,20076843,20076850,20082131,20082132,20083483,20088009,20089253,20102862,20103757,20104933,20105114,20117058,20129295,20137476,20137710,20138472,20144162,20152225,20152245,20154410,20159045,20164787,20170505,20177655,20178563,20179717,20184511,20189089,20189946,20193794,20200016,20204533,20206320,20206540,20210731,20211292,20211293,20211294,20211302,20215126,20226475,20231232,20235224,20337751,20339034,20345495,20352374,20362712,20367660,20370795,20378073,20379004,20381077,20381664,20381665,20381820,20384650,20384658,20387748,20399982,20399987,20400766,20403486,20403817,20406769,20407957,20413028,20425703,20429697,20430112,20435196,20436046,20447580,20447945,20455988,20458822,20459399,20472812,20487117,20487119,20487528,20488299,20488301,20520539,20524462,20528997,20537923,20538128,20538830,20546155,20548978,20569652,20569725,20573636,20573799,20598970,20598971,20599398,20609686,20610490,20624624,20631453,20636313,20639187,20642710,20645962,20651263,20655037,20657612,20662976,20663131,20668354,20676664,20678129,20685676,20694273,20697028,20702884,20706307,20726843,20729747,20800542,20801496,20801924,20802247,20807278,20811347,20813280,20825761,20826259,20837368,20837925,20852299,20855664,20858671,20869199,20876046,20876603,20886196,20920306,20931822,20934554,20934556,20934571,20940250,20946227,20951321,20956032,20956034,20956254,20956256,20961244,20962419,20964739,20965978,20966417,20967400,20976374,20979470,21029824,21029825,21037322,21047492,21051458,21055014,21055479,21056700,21059484,21059740,21063118,21070885,21076147,21076158,21078810,21087332,21090829,21091736,21094362,21098467,21098510,21099681,21105855,21108566,21110181,21111555,21118555,21129714,21129991,21135293,21135809,21135811,21135980,21135985,21135986,21136011,21147262,21147728,21148662,21148666,21156772,21157365,21166099,21166630,21169029,21172721,21175515,21182985,21199686,21200007,21200103,21208228,21208945,21211688,21214105,21215227,21224931,21227948,21232631,21232669,21233260,21235460,21237502,21247589,21248246,21250983,21251026,21251583,21256308,21259273,21259274,21269646,21285399,21286676,21288278,21296333,21298209,21300730,21303900,21308791,21309657,21315835,21321155,21321461,21324118,21324421,21324629,21325345,21329856,21329857,21329859,21329860,21329861,21329862,21329863,21329864,21329865,21329866,21329867,21332861,21335482,21336615,21338711,21344358,21348320,21352390,21353585,21355944,21369791,21382897,21383328,21385466,21388310,21388771,21392636,21392637,21397045,21400088,21411211,21411487,21413975,21415134,21421574,21422032,21436594,21438804,21438891,21440143,21441645,21457789,21457793,21461366,21465955,21465988,21470872,21477372,21478384,21483169,21485666,21501179,21512184,21515596,21517667,21524033,21525032,21529734,21529739,21539635,21543294,21545990,21561900,21563145,21565866,21570534,21576129,21576658,21599901,21606084,21609534,21614408,21614530,21619383,21623642,21624541,21628615,21632865,21649609,21649779,21664624,21667097,21668564,21670542,21674428,21692021,21692897,21700651,21712261,21713745,21717198,21723708,21737164,21742090,21742102,21744157,21757483,21757938,21762871,21784372,21785808,21786177,21788962,21789692,21791142,21791522,21798501,21800003,21801903,21806315,21810865,21815963,21816128,21819434,21821732,21826019,21830957,21833915,21835301,21841092,21841207,21844082,21844156,21846873,21851883,21854895,21856809,21860188,21864856,21870978,21873708,21885540,21885541,21892216,21895039,21903982,21908159,21908956,21911317,21914315,21920481,21920484,21923439,21924760,21925051,21925716,21926261,21930315,21930653,21935581,21938518,21946315,21946316,21946769,21946939,21950798,21954992,21955215,21962449,21972820,21983111,21983766,21983958,21985750,21988947,21992849,21995973,21996393,21998051,22005390,22007032,22009136,22017782,22018484,22026393,22034996,22041335,22041946,22042753,22048744,22050394,22054110,22054659,22067002,22070095,22078420,22082198,22082673,22084332,22086523,22090167,22093613,22093805,22094451,22095616,22098994,22106360,22108302,22113749,22117033,22117962,22118502,22118824,22119854,22119909,22120130,22123602,22128614,22135319,22137082,22137804,22139886,22143010,22147839,22149318,22157519,22165184,22167572,22170195,22171925,22187425,22187510,22193837,22193839,22204226,22205496,22205497,22215856,22217936,22219405,22219409,22229972,22235005,22236222,22246946,22246947,22246948,22246949,22246951,22249647,22262600,22268375,22271713,22276626,22276627,22277458,22285969,22298161,22298168,22303738,22304704,22305462,22309303,22314739,22315112,22315262,22315266,22315271,22340263,22340570,22351917,22361918,22364379,22367842,22368149,22370770,22371104,22374183,22376147,22381428,22386883,22389052,22392459,22395336,22402056,22417716,22418856,22419797,22422743,22429251,22429859,22433576,22433754,22436544,22441062,22441774,22450212,22453654,22453684,22458127,22459778,22464260,22469100,22475708,22480376,22490637,22492518,22494043,22494451,22495138,22503581,22510160,22510269,22511532,22513945,22513959,22516832,22518389,22518390,22520536,22520937,22522403,22523379,22537354,22538330,22539099,22539136,22539138,22542066,22544366,22546623,22554025,22560953,22561296,22565619,22565860,22572045,22572202,22583843,22592700,22608952,22614237,22617224,22617504,22621799,22622124,22622138,22624161,22624265,22633297,22646992,22658300,22661621,22664783,22664798,22669994,22670051,22680238,22681963,22684015,22689712,22689718,22690879,22693869,22696519,22698765,22701382,22702369,22707642,22708978,22713626,22717589,22719025,22719063,22723034,22726401,22729297,22733833,22735257,22738822,22739760,22741473,22743782,22753219,22764183,22764199,22764329,22770423,22770643,22771555,22779430,22782971,22787066,22791299,22795275,22798522,22801398,22815321,22818021,22821004,22824930,22825342,22827490,22832674,22836303,22842285,22845814,22853726,22858114,22858430,22858728,22861171,22863685,22878793,22882993,22894625,22896584,22897339,22897649,22899743,22900930,22906107,22906900,22912382,22913568,22914573,22915788,22922413,22923145,22928173,22930458,22932307,22933567,22939852,22947592,22951598,22953789,22956554,22958623,22958958,22964356,22967497,22972873,22973107,22978656,22985610,22989818,22992480,22993019,22995971,22997929,22997994,23001018,23008509,23010989,23015216,23016248,23018151,23018991,23022248,23027801,23031622,23033347,23036896,23040570,23052711,23054128,23059130,23060423,23062052,23062482,23067130,23071159,23086966,23087399,23088936,23092527,23094720,23097006,23097051,23097606,23101282,23107870,23111138,23112110,23114904,23121681,23126003,23127191,23128104,23129490,23130627,23130754,23131063,23131083,23137520,23141526,23150654,23160338,23167273,23169946,23171447,23185817,23186806,23194489,23200094,23209837,23210452,23210695,23212720,23218998,23219385,23223178,23224686,23229176,23229461,23232844,23236970,23239219,23244363,23249156,23249869,23253272,23253701,23258136,23259448,23265231,23265334,23265344,23271794,23274306,23275465,23276475,23280480,23289002,23293924,23295101,23299710,23307444,23312964,23315281,23315607,23324508,23325525,23329893,23330766,23338902,23343564,23347027,23348641,23348922,23364221,23364608,23365968,23369365,23379836,23381198,23382294,23390125,23391196,23402443,23403268,23403768,23406625,23410497,23410544,23421535,23430665,23434517,23437787,23437987,23438932,23440790,23441593,23444271,23448155,23460057,23471344,23474607,23482597,23487517,23489944,23494488,23497611,23500267,23500276,23500298,23500312,23515263,23515264,23521615,23524091,23525418,23525440,23529661,23537812,23540545,23543662,23546173,23548422,23549989,23557493,23563134,23566712,23567775,23571795,23572499,23575816,23577826,23580744,23586654,23587470,23592708,23598585,23601079,23606551,23623647,23625309,23625942,23625943,23626785,23629735,23633374,23636477,23640971,23644091,23667912,23669885,23670121,23685539,23696697,23701516,23707298,23722644,23723250,23726175,23734260,23736948,23737228,23743976,23748210,23751149,23769405,23770172,23770182,23770747,23778563,23778903,23787195,23796283,23803629,23815891,23868858,23895805,23899913,23909542,23916928,23932012,23932258,23939455,23940388,23941163,23942679,23945170,23988341,23991661,23993247,23993352,24009307,24016454,24016492,24016506,24016507,24016511,24054920,24054956,24088003,24093846,24145742,24176451,24195206,24240932,24251359,24251363) 
-- AND predicate = 'TREATS' 
-- AND o_CUI IN('C2926591','C0004238') 
-- AND s_novel = 1
-- AND SENTENCE.SENTENCE_ID=SID

--- atrial fibrillation (with novel)
SELECT count(*), s_cui, s_name,
  case
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1980 and 1985 then '1980-1985'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1986 and 1990 then '1986-1990'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1991 and 1995 then '1991-1995'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1996 and 2000 then '1996-2000'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 2001 and 2005 then '2001-2005'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 2006 and 2010 then '2006-2010'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 2011 and 2013 then '2011-2013' end as year_range
FROM PREDICATION_AGGREGATE pa 
join SENTENCE s on s.sentence_id =  pa.sid 
join CITATIONS c on c.pmid = s.pmid
WHERE predicate = 'TREATS'  
AND o_CUI IN('C2926591','C0004238') 
AND s_novel = 1
having year_range <> NULL
order by year_range, s_name;

--- atrial fibrillation (without novel)

SELECT count(*), s_cui, s_name,
  case
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1980 and 1985 then '1980-1985'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1986 and 1990 then '1986-1990'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1991 and 1995 then '1991-1995'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 1996 and 2000 then '1996-2000'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 2001 and 2005 then '2001-2005'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 2006 and 2010 then '2006-2010'
    when CAST(SUBSTRING(dp, 1, 4) AS DECIMAL) between 2011 and 2013 then '2011-2013' end as year_range
FROM PREDICATION_AGGREGATE pa 
join SENTENCE s on s.sentence_id =  pa.sid 
join CITATIONS c on c.pmid = s.pmid
WHERE predicate = 'TREATS'  
AND o_CUI IN('C2926591','C0004238') 
order by year_range, s_name;